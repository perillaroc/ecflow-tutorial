<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.54.0" />
    <meta name="description" content="">


    <link rel="icon" href="https://perillaroc.github.io/ecflow-tutorial-cn/images/favicon.png" type="image/png">

    <title>加载文件 :: ecFlow教程中文版</title>

    
    <link href="https://perillaroc.github.io/ecflow-tutorial-cn/css/nucleus.css?1554043307" rel="stylesheet">
    <link href="https://perillaroc.github.io/ecflow-tutorial-cn/css/fontawesome-all.min.css?1554043307" rel="stylesheet">
    <link href="https://perillaroc.github.io/ecflow-tutorial-cn/css/hybrid.css?1554043307" rel="stylesheet">
    <link href="https://perillaroc.github.io/ecflow-tutorial-cn/css/featherlight.min.css?1554043307" rel="stylesheet">
    <link href="https://perillaroc.github.io/ecflow-tutorial-cn/css/perfect-scrollbar.min.css?1554043307" rel="stylesheet">
    <link href="https://perillaroc.github.io/ecflow-tutorial-cn/css/auto-complete.css?1554043307" rel="stylesheet">
    <link href="https://perillaroc.github.io/ecflow-tutorial-cn/css/theme.css?1554043307" rel="stylesheet">
    <link href="https://perillaroc.github.io/ecflow-tutorial-cn/css/hugo-theme.css?1554043307" rel="stylesheet">
    

    <script src="https://perillaroc.github.io/ecflow-tutorial-cn/js/jquery-2.x.min.js?1554043307"></script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/chap02/load-file/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://perillaroc.github.io/ecflow-tutorial-cn/">
<svg id="grav-logo" xmlns="http://www.w3.org/2000/svg" style="width:100%; height:100%;" viewBox="0 0 121.58 26">
  <defs>
    <style>
      .a {
        fill: none;
        stroke: white;
        stroke-linecap: round;
        stroke-miterlimit: 10;
        stroke-width: 2px;
      }

      .b {
        font-size: 18px;
        font-family: BerlinSansFB-Reg, Berlin Sans FB;
        fill: white;
      }
    </style>
  </defs>
  <circle class="a" cx="13" cy="13" r="12" /><text class="b" transform="translate(29.75 18.75)">NWP-OPER</text>
  <line class="a" x1="4" y1="20.11" x2="7" y2="14.11" />
  <line class="a" x1="12" y1="18.11" x2="7" y2="14.11" />
  <line class="a" x1="17" y1="13.11" x2="12" y2="18.11" />
  <line class="a" x1="23" y1="19.11" x2="17" y2="13.11" />
</svg>
</a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="https://perillaroc.github.io/ecflow-tutorial-cn/js/lunr.min.js?1554043307"></script>
<script type="text/javascript" src="https://perillaroc.github.io/ecflow-tutorial-cn/js/auto-complete.js?1554043307"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/perillaroc.github.io\/ecflow-tutorial-cn\/";
    
</script>
<script type="text/javascript" src="https://perillaroc.github.io/ecflow-tutorial-cn/js/search.js?1554043307"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

          
          
          


 
  
    
    <li data-nav-id="/chap01/" title="1. 介绍" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap01/">
          1. 介绍
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/chap02/" title="2. 开始使用" class="dd-item 
        parent
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap02/">
          2. 开始使用
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
          
          
            
            


 
  
    
    <li data-nav-id="/chap02/use-ecflow-ui/" title="使用 ecflow_ui" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap02/use-ecflow-ui/">
          使用 ecflow_ui
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap02/load-file/" title="加载文件" class="dd-item 
        parent
        active
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap02/load-file/">
          加载文件
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap02/start-suite/" title="启动suite" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap02/start-suite/">
          启动suite
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/chap02/define-new-suite/" title="定义新的 suite" class="dd-item ">
        <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap02/define-new-suite/">
        定义新的 suite
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/chap02/define-first-task/" title="定义第一个task" class="dd-item ">
        <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap02/define-first-task/">
        定义第一个task
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap02/execute-rerun-requeue/" title="执行、重新执行、重新排队" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap02/execute-rerun-requeue/">
          执行、重新执行、重新排队
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/chap02/check-job-creation/" title="检查job生成" class="dd-item ">
        <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap02/check-job-creation/">
        检查job生成
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/chap02/check-result/" title="检查结果" class="dd-item ">
        <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap02/check-result/">
        检查结果
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/chap02/understand-includes/" title="理解头文件" class="dd-item ">
        <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap02/understand-includes/">
        理解头文件
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/chap02/understand-client/" title="理解客户端" class="dd-item ">
        <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap02/understand-client/">
        理解客户端
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/chap03/" title="3. 进一步" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap03/">
          3. 进一步
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
          
          
            
            


 
  
    
    <li data-nav-id="/chap03/families/" title="Families" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap03/families/">
          Families
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap03/ecflow-variable/" title="ecFlow变量" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap03/ecflow-variable/">
          ecFlow变量
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap03/variable-inheritance/" title="变量继承" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap03/variable-inheritance/">
          变量继承
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap03/time-dependencies/" title="时间依赖" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap03/time-dependencies/">
          时间依赖
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap03/add-cron/" title="添加 Cron" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap03/add-cron/">
          添加 Cron
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap03/add-complete/" title="添加complete" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap03/add-complete/">
          添加complete
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap03/add-meter/" title="添加meter" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap03/add-meter/">
          添加meter
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap03/add-event/" title="添加事件" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap03/add-event/">
          添加事件
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap03/add-another-task/" title="添加另一个任务" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap03/add-another-task/">
          添加另一个任务
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap03/add-trigger/" title="添加触发器" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap03/add-trigger/">
          添加触发器
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap03/add-manual/" title="添加说明" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap03/add-manual/">
          添加说明
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/chap04/" title="4. 高级话题" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap04/">
          4. 高级话题
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
          
          
            
            


 
  
    
    <li data-nav-id="/chap04/alias/" title="Alias" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap04/alias/">
          Alias
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap04/label/" title="Label" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap04/label/">
          Label
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap04/late-attribute/" title="Late 属性" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap04/late-attribute/">
          Late 属性
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap04/limit/" title="Limit" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap04/limit/">
          Limit
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap04/repeat/" title="Repeat" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap04/repeat/">
          Repeat
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap04/zombie/" title="Zombie 介绍" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap04/zombie/">
          Zombie 介绍
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap04/python/" title="使用 python 脚本" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap04/python/">
          使用 python 脚本
          
      </a>
      
      
        <ul>
          
          
          
          
          
          
            
            


 
  
    
      <li data-nav-id="/chap04/python/indentation/" title="缩进" class="dd-item ">
        <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap04/python/indentation/">
        缩进
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/chap04/python/object-oriented-suites/" title="面向对象suite" class="dd-item ">
        <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap04/python/object-oriented-suites/">
        面向对象suite
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap04/file-location/" title="文件位置" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap04/file-location/">
          文件位置
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap04/data-and-clock/" title="日期和时钟" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap04/data-and-clock/">
          日期和时钟
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap04/server_security/" title="服务安全" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap04/server_security/">
          服务安全
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/chap04/run-remote-job/" title="运行远程作业" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap04/run-remote-job/">
          运行远程作业
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/chap05/" title="5. 练习" class="dd-item 
        
        
        
        ">
      <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap05/">
          5. 练习
          
      </a>
      
      
        <ul>
          
          
          
          
          
          
            
            


 
  
    
      <li data-nav-id="/chap05/bask-archiving/" title="Back Archiving" class="dd-item ">
        <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap05/bask-archiving/">
        Back Archiving
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/chap05/operation-suite/" title="业务Suite" class="dd-item ">
        <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap05/operation-suite/">
        业务Suite
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/chap05/data-acquisition/" title="数据获取" class="dd-item ">
        <a href="https://perillaroc.github.io/ecflow-tutorial-cn/chap05/data-acquisition/">
        数据获取
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='https://perillaroc.github.io/ecflow-tutorial-cn/'>ecFlow教程</a> > <a href='https://perillaroc.github.io/ecflow-tutorial-cn/chap02/'>2. 开始使用</a> > 加载文件
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#文本">文本</a></li>
<li><a href="#python">Python</a></li>
<li><a href="#任务">任务</a></li>
<li><a href="#备注">备注</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              加载文件
            </h1>
          

        




	

<p>下一步就是让 <code>ecflow_server</code> 知道你的 suite，或者称为加载 suite definition 文件。
这一步将检查 <code>test.def</code> 文件，并向 <code>ecflow_server</code> 描述 suite。可以通过多种方法实现，取决于 suite 的创建方式。</p>

<p>注意：从下面的两种方法中选择一种方法，避免两次加载 suite definition 时会出现的错误。</p>

<h2 id="文本">文本</h2>

<p>在 <code>ECF_HOME</code> 目录执行下面的命令</p>

<pre><code>$ecflow_client --load=test.def --port=33083
</code></pre>

<p>这将检查并加载 suite definition 到 <code>ecflow_server</code>。如果检查失败，suite 不会被加载。
之前的章节中提到过 <code>ecflow_client</code>，该命令被用在 <code>head.h</code> 和 <code>tail.h</code> 头文件中。</p>

<p>注：请确保已经设置 <code>ECF_HOST</code> 和 <code>ECF_PORT</code> 环境变量，否则需要在命令行中使用 <code>--host</code> 和 <code>-–port</code> 参数。</p>

<p>加载 suite 后的 ecflowview</p>

<p><img src="asset/ecflowview-after-suite-loaded.jpg" alt="" /></p>

<p><strong>译者注：</strong></p>

<p>为了测试另一种方式，需要删除 ecflow 服务中的 suite，使用 <code>ecflow_client --delete</code> 命令：</p>

<pre><code>$ecflow_client --host=login05 --port=33083 --delete=/test
Are you sure want to delete nodes at paths:
  /test ? y
</code></pre>

<h2 id="python">Python</h2>

<p>使用 Python 脚本将 defs 写为 <code>.def</code> 定义文件，在 suite 定义比较复杂的时候对调试很有帮助。</p>

<pre><code class="language-py">import os
from pathlib import Path
from ecflow import Defs, Suite, Task, Edit

print(&quot;Creating suite definition&quot;)
home = os.path.abspath(Path(Path(__file__).parent, &quot;../../../build/course&quot;))
defs = Defs(
    Suite('test',
          Edit(ECF_HOME=home),
          Task('t1')))
print(defs)

print(&quot;Checking job creation: .ecf -&gt; .job0&quot;)
print(defs.check_job_creation())

print(&quot;Saving definition to file 'test.def'&quot;)
defs.save_as_defs(str(Path(home, &quot;test.def&quot;)))

# To restore the definition from file 'test.def' we can use:
# restored_defs = ecflow.Defs(&quot;test.def&quot;)
</code></pre>

<p>输出结果：</p>

<pre><code>$python test.py
Creating suite definition
# 4.8.0
suite test
  edit ECF_HOME 'PROJECT_ROOT/build/course'
  task t1
endsuite

Checking job creation: .ecf -&gt; .job0

Saving definition to file 'test.def'
</code></pre>

<p>运行上述脚本后，生成的 def 文件内容如下：</p>

<pre><code class="language-bash"># 4.8.0
suite test
  edit ECF_HOME 'PROJECT_ROOT/build/course'
  task t1
endsuite
</code></pre>

<p>可以使用上面的方法通过命令行接口加载 def 文件。</p>

<p>因为 Suite Definition API 在内存中建立 definition，所以可以直接加载到 <code>ecflow_server</code> 中，用 <code>ecflow.Client</code> 类实现。</p>

<p>在之前的 <code>test.py</code> 文件结尾添加如下代码：</p>

<pre><code class="language-py">try:
    print(&quot;Load the in memory definition(defs) into the server&quot;)
    ci = Client('login05', '33083')
    ci.load(defs)
except RuntimeError as e:
    print(&quot;Failed:&quot;, e)
</code></pre>

<p>运行修改后的代码：</p>

<pre><code>$ python test.py
Creating suite definition
# 4.0.9
suite test
  edit ECF_HOME '/home/windroc/course'
  task t1
endsuite

Checking job creation: .ecf -&gt; .job0

Saving definition to file 'test.def'
Load the in memory definition(defs) into the server
</code></pre>

<p>在 <code>ecflow_ui</code> 中可以看到 <code>test</code> 已加载到 ecflow 服务中。</p>

<p><img src="./assert/ecflowui_load_file_direct.png" alt="" /></p>

<p>此时服务处于 halted 状态，需要手动开启服务。</p>

<pre><code>$ecflow_client --begin --host=login05 --port=33083
</code></pre>

<p>因为没有添加任何触发机制，在服务开始后，t1 就会立即执行，执行结束后的状态如下：</p>

<p><img src="./assert/ecflowui_load_file_direct_after_begin.png" alt="" /></p>

<p>强烈建议创建 suite definition 和将它加载到服务器的过程分开。加载过程应该放到一个文件中，例如下面的 <code>client.py</code> 文件。</p>

<pre><code class="language-py">import os
from pathlib import Path
import ecflow

home = os.path.abspath(Path(Path(__file__).parent, &quot;../../../build/course&quot;))
try:
    print(&quot;Loading definition in 'test.def' into the server&quot;)
    ci = ecflow.Client('login05', '33083')
    ci.load(str(Path(home, &quot;test.def&quot;)))  # read definition from disk and load into the server
except RuntimeError as e:
    print(&quot;Failed:&quot;, e)
</code></pre>

<p>测试结果：</p>

<pre><code>$python test_client.py
Loading definition in 'test.def' into the server
</code></pre>

<p>如果一切顺利，server 中应该有 suite 的定义。<code>ecflow_server</code> 的日志文件中会记录 <code>ecflow_client</code> 的调用情况：</p>

<pre><code>MSG:[14:07:06 30.1.2018] --delete yes /test  :wangdp
...
MSG:[14:08:05 30.1.2018] --load=/g3/wangdp/project/study/ecflow/ecflow-tutorial-code/build/course/test.def  :wangdp
...
MSG:[14:09:14 30.1.2018] --begin :wangdp
LOG:[14:09:14 30.1.2018]  queued: /test
LOG:[14:09:14 30.1.2018]  queued: /test/t1
LOG:[14:09:14 30.1.2018]  queued: /
LOG:[14:09:14 30.1.2018]  submitted: /test/t1 job_size:1843
LOG:[14:09:14 30.1.2018]  submitted: /test
LOG:[14:09:14 30.1.2018]  submitted: /
MSG:[14:09:14 30.1.2018] chd:init /test/t1
LOG:[14:09:14 30.1.2018]  active: /test/t1
LOG:[14:09:14 30.1.2018]  active: /test
LOG:[14:09:14 30.1.2018]  active: /
MSG:[14:09:14 30.1.2018] chd:complete /test/t1
LOG:[14:09:14 30.1.2018]  complete: /test/t1
LOG:[14:09:14 30.1.2018]  complete: /test
LOG:[14:09:14 30.1.2018]  complete: /
...
</code></pre>

<h2 id="任务">任务</h2>

<ol>
<li>加载定义文件。从上述两种方法中选择一种。</li>
<li>如果使用python方式，检查 <code>test.def</code> 并创建 <code>client.py</code></li>
<li>查看日志文件</li>
</ol>

<h2 id="备注">备注</h2>

<p>如果遇到重复加载两次 suite 的错误，可以删掉服务器中的 suite</p>

<pre><code>ecflow_client --delete /test
</code></pre>

<p>然后 definition 可以被重新加载。</p>

<p>或者使用 <code>replace</code> 替换 suite，请查看相关帮助</p>

<pre><code class="language-text">$ecflow_client --help replace

replace
-------

Replaces a node in the server, with the given path
Can also be used to add nodes in the server
  arg1 = path to node
         must exist in the client defs(arg2). This is also the node we want to
         replace in the server
  arg2 = path to client definition file
         provides the definition of the new node
  arg3 = (optional) [ parent | false ] (default = parent)
         create parent families or suite as needed, when arg1 does not
         exist in the server
  arg4 = (optional) force (default = false) 
         Force the replacement even if it causes zombies to be created
Replace can fail if:
- The node path(arg1) does not exist in the provided client definition(arg2)
- The client definition(arg2) must be free of errors
- If the third argument is not provided, then node path(arg1) must exist in the server
- Nodes to be replaced are in active/submitted state, in which case arg4(force) can be used

After replace is done, we check trigger expressions. These are reported to standard output.
It is up to the user to correct invalid trigger expressions, otherwise the tasks will *not* run.
Please note, you can use --check to check trigger expression and limits in the server.
For more information use --help check.

Usage:
  --replace=/suite/f1/t1 /tmp/client.def  parent      # Add/replace node tree /suite/f1/t1
  --replace=/suite/f1/t1 /tmp/client.def  false force # replace t1 even if its active or submitted

The client reads in the following environment variables. These are read by user and child command

|----------|----------|------------|-------------------------------------------------------------------|
| Name     |  Type    | Required   | Description                                                       |
|----------|----------|------------|-------------------------------------------------------------------|
| ECF_NODE | &lt;string&gt; | Mandatory* | The host name of the main server. defaults to 'localhost'         |
| ECF_PORT |  &lt;int&gt;   | Mandatory* | The TCP/IP port to call on the server. Must be unique to a server |
|----------|----------|------------|-------------------------------------------------------------------|

* The host and port must be specified in order for the client to communicate with the server, this can 
  be done by setting ECF_NODE, ECF_PORT or by specifying --host &lt;host&gt; --port &lt;int&gt; on the command line
</code></pre>

<p><strong>简要说明</strong></p>

<pre><code class="language-bash"># 替换整个 suite
ecflow_client --replace=/test test.def

# 或者替换单个节点
ecflow_client --replace=/test/f1/t1 test.def
</code></pre>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="https://perillaroc.github.io/ecflow-tutorial-cn/chap02/understand-client/" title="理解客户端"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="https://perillaroc.github.io/ecflow-tutorial-cn/chap02/start-suite/" title="启动suite" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="https://perillaroc.github.io/ecflow-tutorial-cn/js/clipboard.min.js?1554043307"></script>
    <script src="https://perillaroc.github.io/ecflow-tutorial-cn/js/perfect-scrollbar.min.js?1554043307"></script>
    <script src="https://perillaroc.github.io/ecflow-tutorial-cn/js/perfect-scrollbar.jquery.min.js?1554043307"></script>
    <script src="https://perillaroc.github.io/ecflow-tutorial-cn/js/jquery.sticky.js?1554043307"></script>
    <script src="https://perillaroc.github.io/ecflow-tutorial-cn/js/featherlight.min.js?1554043307"></script>
    <script src="https://perillaroc.github.io/ecflow-tutorial-cn/js/html5shiv-printshiv.min.js?1554043307"></script>
    <script src="https://perillaroc.github.io/ecflow-tutorial-cn/js/highlight.pack.js?1554043307"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://perillaroc.github.io/ecflow-tutorial-cn/js/modernizr.custom.71422.js?1554043307"></script>
    <script src="https://perillaroc.github.io/ecflow-tutorial-cn/js/learn.js?1554043307"></script>
    <script src="https://perillaroc.github.io/ecflow-tutorial-cn/js/hugo-learn.js?1554043307"></script>

    <link href="https://perillaroc.github.io/ecflow-tutorial-cn/mermaid/mermaid.css?1554043307" type="text/css" rel="stylesheet" />
    <script src="https://perillaroc.github.io/ecflow-tutorial-cn/mermaid/mermaid.js?1554043307"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>
